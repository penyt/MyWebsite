<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>traefik on ä¼éµçª©</title>
        <link>https://li.penli.quest/tags/traefik/</link>
        <description>Recent content in traefik on ä¼éµçª©</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-tw</language>
        <copyright>Pen</copyright>
        <lastBuildDate>Thu, 16 Jan 2025 14:33:23 +0000</lastBuildDate><atom:link href="https://li.penli.quest/tags/traefik/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>åœ¨ Docker Swarm éƒ¨ç½² traefik ä»¥å¯¦ç¾è·¨ä¸»æ©Ÿä»£ç†</title>
        <link>https://li.penli.quest/p/docker-swarm-traefik/</link>
        <pubDate>Thu, 16 Jan 2025 14:33:23 +0000</pubDate>
        
        <guid>https://li.penli.quest/p/docker-swarm-traefik/</guid>
        <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;å¦‚æœä½ æœ‰å¤šå°ä¸»æ©Ÿï¼Œä¸¦ä¸”æ¶è¨­äº† docker æœå‹™ï¼Œå…¶å¯¦å¯ä»¥ä¸ç”¨å†æ¯ä¸€å°ä¸»æ©Ÿä¸Šéƒ½éƒ¨ç½² traefik ä¾†è™•ç†æ¯å€‹å®¹å™¨çš„åå‘ä»£ç†å’Œ TLS è­‰æ›¸&lt;/p&gt;
&lt;p&gt;ç•¶ç„¶ï¼Œå¦‚æœåœ¨åŒä¸€å€‹å€åŸŸç¶²è·¯ä¸‹ï¼Œå¯ä»¥ç°¡å–®åœ°ä½¿ç”¨ traefik çš„å‹•æ…‹é…ç½®æ–‡ä»¶åšåˆ°&lt;/p&gt;
&lt;p&gt;å¯æ˜¯å¦‚æœä»Šå¤©ä¸åœ¨åŒä¸€å€åŸŸç¶²è·¯ä¸‹å‘¢ï¼Ÿå¸¸è¦‹çš„æƒ…æ³å°±æ˜¯åœ¨ä¸åŒå€åŸŸç¶²è·¯ä¸‹çš„å¤šå° VPS&lt;/p&gt;
&lt;p&gt;åˆæˆ–è€…ï¼Œå°±æ˜¯æƒ³è¦ä½¿ç”¨ docker çš„ traefik label ä¾†è¨­å®šä¸­é–“ä»¶ï¼ˆmiddlewareï¼‰å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç•¢ç«Ÿå¦‚æœæƒ³è¦æ·»åŠ  authentikã€authelia é€™é¡çš„æˆæ¬Šé é¢ï¼Œæˆ–è€…ä½¿ç”¨ crowdsecï¼Œåˆ©ç”¨ traefik çš„ä¸­é–“ä»¶å…¶å¯¦éå¸¸æ–¹ä¾¿è¨­ç½®&lt;/p&gt;
&lt;p&gt;å…¶å¯¦é‚„æœ‰ä¸€å€‹æ–¹æ³•ï¼Œé‚£å°±æ˜¯åœ¨ docker swarm ä¸‹éƒ¨ç½²å®¹å™¨ï¼Œä¸¦åˆ©ç”¨ overlay network ä¾†åšåˆ°è·¨è¶Šå¤šå° docker ä¸»æ©Ÿçš„ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯é€™ç¯‡æ–‡ç« çš„å…§å®¹&lt;/p&gt;
&lt;h2 id=&#34;-docker-swarm-çš„å¥½è™•&#34;&gt;ğŸ§ docker swarm çš„å¥½è™•&lt;/h2&gt;
&lt;h3 id=&#34;i-éœ€æ±‚å°‘&#34;&gt;I. éœ€æ±‚å°‘&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ çš„æ©Ÿå™¨æ²’æœ‰å…¬å…± IPï¼ˆpublic IPï¼‰ï¼Œåƒæ˜¯å®¿èˆæˆ–å…¬å¯“è£¡è‡ªæ¶çš„ä¼ºæœå™¨ï¼Œä½ æœªå¿…æœƒæœ‰æœ€ä¸Šæ¸¸ NAT çš„æ¬Šé™ä¾†è¨­ç½®ç«¯å£è½‰ç™¼ï¼ˆport fowardingï¼‰ï¼Œé‚£éº¼åœ¨é€™å°ä¸»æ©Ÿä¸Šæ‰€è¨­ç½®çš„æœå‹™ï¼Œä¾¿æœƒç„¡æ³•æš´éœ²åˆ°å¤–ç¶²&lt;/p&gt;
&lt;p&gt;è€Œè‹¥ä½¿ç”¨ docker swarmï¼Œä¾¿åªéœ€è¦åœ¨ä¸€å°æ©Ÿå™¨ä¸Šéƒ¨ç½² traefik é€²è¡Œåå‘ä»£ç†ï¼Œå°±å¯ä»¥æŠŠä½ å®¶è£¡ä¼ºæœå™¨ä¸Šçš„æœå‹™æˆ–ç¶²ç«™æš´éœ²åˆ°å¤–ç¶²&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;center&gt;å¥½è™•å°±æ˜¯ï¼šåªéœ€è¦æœ‰ä¸€å€‹å…¬å…± IPã€åªéœ€è¦éƒ¨ç½²ä¸€å€‹ traefik&lt;/center&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸” docker swarm æ˜¯ docker å…§å»ºçš„åŠŸèƒ½ï¼Œåœ¨å®Œæ•´å®‰è£ docker engine çš„æ™‚å€™å°±å­˜åœ¨äº†ï¼Œä¹Ÿä¸æœƒä½”ç”¨å¾ˆå¤šè³‡æº&lt;/p&gt;
&lt;h3 id=&#34;ii-å®¹æ˜“è¨­ç½®&#34;&gt;II. å®¹æ˜“è¨­ç½®&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ docker swarm åªéœ€è¦ç°¡å–®ä¿®æ”¹ä¸€ä¸‹ docker çš„ &amp;ldquo;labels&amp;rdquo; å€å¡Šï¼Œå’Œéƒ¨ç½²æ‡‰ç”¨ç¨‹å¼æ™‚çš„ docker å‘½ä»¤ï¼Œå°±å¯ä»¥å®Œæˆäº†&lt;/p&gt;
&lt;h2 id=&#34;-æ“ä½œæ–¹æ³•&#34;&gt;ğŸ§ æ“ä½œæ–¹æ³•&lt;/h2&gt;
&lt;p&gt;&lt;font color=#FF0000&gt; host1 &lt;/font&gt; :  æ“æœ‰å…¬å…±ï¼©ï¼°ï¼Œä¸¦ä¸” traefik å°‡éƒ¨ç½²åœ¨é€™è£¡&lt;br&gt;
&lt;font color=#3FB6F5&gt; host2 &lt;/font&gt; :  ã€Œæ²’æœ‰ã€å…¬å…±ï¼©ï¼°ï¼Œå…¶ä»–çš„ app æœƒéƒ¨ç½²åœ¨é€™è£¡&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬ä¸€æ­¥åˆå§‹åŒ–-docker-swarm&#34;&gt;ç¬¬ä¸€æ­¥ï¼Œåˆå§‹åŒ– docker swarm&lt;/h3&gt;
&lt;p&gt;åœ¨ &lt;font color=#FF0000&gt; host1 &lt;/font&gt; åŸ·è¡Œ:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker swarm init
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»–æœƒè¼¸å‡ºåƒé€™æ¨£çš„å…§å®¹ï¼Œä½†é€™æ˜¯è¨­ç½® worker ç”¨çš„tokenï¼š&lt;br&gt;
&lt;code&gt;docker swarm join --token THISIS-7-89456123789aworker456987token....... IP_ADDR:2377&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–é‚„æœƒæœ‰ä¸€è¡Œï¼Œé€™è¡Œæ‰æ˜¯æˆ‘å€‘éœ€è¦ä½¿ç”¨çš„ï¼š&lt;br&gt;
&lt;code&gt;To add a manager to this swarm, run &#39;docker swarm join-token manager&#39; and follow the instructions.&lt;/code&gt;&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;æ‰€ä»¥æ¥è‘—ï¼Œç¹¼çºŒåœ¨ &lt;font color=#FF0000&gt; host1 &lt;/font&gt; åŸ·è¡Œ:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker swarm join-token manager
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»–æœƒè¼¸å‡ºåƒé€™æ¨£çš„å…§å®¹ï¼Œé€™æ˜¯è¨­ç½® &lt;strong&gt;manager&lt;/strong&gt; ç”¨çš„tokenï¼š&lt;br&gt;
&lt;code&gt;docker swarm join --token MAGENA-7-89456123789r456987token....... IP_ADDR:2377&lt;/code&gt;&lt;/p&gt;
&lt;br&gt;
&lt;h3 id=&#34;ç¬¬äºŒæ­¥å°‡-host2-è¨­ç½®æˆ-manager-é-workerå› ç‚º-worker-ç„¡æ³•è‡ªè¡Œéƒ¨ç½²-app-&#34;&gt;ç¬¬äºŒæ­¥ï¼Œå°‡ host2 è¨­ç½®æˆ manager ï¼ˆé workerï¼Œå› ç‚º worker ç„¡æ³•è‡ªè¡Œéƒ¨ç½² app ï¼‰&lt;/h3&gt;
&lt;p&gt;åˆ‡æ›åˆ° &lt;font color=#3FB6F5&gt; host2 &lt;/font&gt; å¾Œï¼ŒåŸ·è¡Œ &lt;strong&gt;MANAGER&lt;/strong&gt; çš„è¨­ç½®å‘½ä»¤&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ï¼ˆè¨˜å¾—è¤‡è£½ä½ è‡ªå·±çš„ï¼‰docker swarm join --token MAGENA-7-8943789r487token....... IP_ADDR:2377
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ¥è‘—ï¼ŒåŸ·è¡Œé€™å€‹å‘½ä»¤ä¾†æª¢æŸ¥ç¯€é»çš„ç‹€æ…‹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker node ls
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‡‰è©²æœƒè¼¸å‡ºåƒé€™æ¨£çš„å…§å®¹:&lt;/p&gt;
&lt;blockquote&gt;
ID                            &amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
HOSTNAME                      &amp;emsp;&amp;emsp;
STATUS    &amp;emsp;&amp;emsp;
AVAILABILITY   &amp;emsp;&amp;emsp;&amp;emsp;
MANAGER STATUS   &amp;emsp;&amp;emsp;&amp;emsp;
ENGINE VERSION    
&lt;p&gt;idofhostt2     â€ƒâ€ƒ
host2     â€ƒâ€ƒâ€ƒâ€ƒ
Ready     â€ƒâ€ƒâ€ƒ
Active         â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ
Reachable        â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ
27.3.1&lt;/p&gt;
&lt;p&gt;idofhostt1 *   â€ƒ
host1   â€ƒâ€ƒâ€ƒâ€ƒ
Ready     â€ƒâ€ƒâ€ƒ
Active         â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ
Leader           â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ
27.3.1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¾åœ¨ï¼Œæˆ‘å€‘å°±æˆåŠŸé€é docker swarm ä¾†é€£æ¥å…©å°è·¨ç¶²è·¯çš„è£ç½®äº†ï¼&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h3 id=&#34;ç¬¬ä¸‰æ­¥æ–°å¢-traefik-çš„-docker-composeyml-å’Œå…¶ä»–é…ç½®æ–‡ä»¶-1&#34;&gt;ç¬¬ä¸‰æ­¥ï¼Œæ–°å¢ traefik çš„ docker-compose.yml å’Œå…¶ä»–é…ç½®æ–‡ä»¶ &lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/h3&gt;
&lt;p&gt;åœ¨ &lt;font color=#FF0000&gt; host1 &lt;/font&gt; æ–°å¢å¦‚ä¸‹æ–¹çš„è³‡æ–™å¤¾å’Œæª”æ¡ˆ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–°å¢è³‡æ–™å¤¾ : &lt;code&gt;mkdir traefik&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é€²å…¥è³‡æ–™å¤¾ : &lt;code&gt;cd traefik&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ–°å¢æª”æ¡ˆ : &lt;code&gt;touch traefik.yml config.yml acme.json docker-compose.yml&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¨­ç½® acme çš„æ¬Šé™ : &lt;code&gt;chmod 600 acme.json&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;traefik&lt;/strong&gt;&lt;br&gt;
â”œ docker-compose.yml&lt;br&gt;
â”œ traefik.yml&lt;br&gt;
â”œ config.yml&lt;br&gt;
â”” acme.json&lt;/p&gt;
&lt;p&gt;ç·¨è¼¯ &lt;a class=&#34;link&#34; href=&#34;https://github.com/penyt/traefik-docker-swarm/blob/main/traefik/docker-compose.yml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;docker-compose.yml
    
    
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    &lt;/a&gt; &lt;code&gt;nano docker-compose.yml&lt;/code&gt;ï¼ŒæŠŠé€£çµè£¡çš„å…§å®¹è²¼ä¸Š;&lt;/p&gt;
&lt;p&gt;ç·¨è¼¯ &lt;a class=&#34;link&#34; href=&#34;https://github.com/penyt/traefik-docker-swarm/blob/main/traefik/traefik.yml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;traefik.yml
    
    
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    &lt;/a&gt; &lt;code&gt;nano traefik.yml&lt;/code&gt;ï¼ŒæŠŠé€£çµè£¡çš„å…§å®¹è²¼ä¸Š&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;(æ­¤æ­¥é©Ÿéå¿…è¦ï¼Œä½†å¼·çƒˆå»ºè­°) åŠ ä¸Šå“ˆå¸Œå¯†ç¢¼&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo apt-get install apache2-utils
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°‡ã€Œusernameã€å’Œã€Œyourpasswordã€è¨­ç½®æˆä½ è‡ªå·±çš„ç”¨æˆ¶åå’Œå¯†ç¢¼&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;htpasswd -nb username yourpassword
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‘½ä»¤åŸ·è¡Œå¾Œï¼Œæœƒå‡ºç¾åƒé€™æ¨£çš„ä¸€ä¸²ï¼š&lt;code&gt;username:$apr1$8VzK7EwL$4Z9T.HqxGkJpAqVnqp4Ol1&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æŠŠæ‰€æœ‰çš„ &lt;code&gt;$&lt;/code&gt; æ”¹æˆ &lt;code&gt;$$&lt;/code&gt; (ä»¥é¿å… docker compose æœƒæŠŠå–®å€‹&lt;code&gt;$&lt;/code&gt;è­¯ç‚ºç’°å¢ƒè®Šæ•¸)&lt;/p&gt;
&lt;p&gt;æ¥è‘—ï¼ŒæŠŠ docker-compose.yml è£¡é¢çš„ &lt;code&gt;user:hashed_password&lt;/code&gt; æ”¹æˆå‰›å‰›å‡ºç¾çš„é‚£ä¸€ä¸²&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h3 id=&#34;ç¬¬å››æ­¥éƒ¨ç½²-traefik&#34;&gt;ç¬¬å››æ­¥ï¼Œéƒ¨ç½² traefik&lt;/h3&gt;
&lt;p&gt;åœ¨ &lt;font color=#FF0000&gt; host1 &lt;/font&gt; åŸ·è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker stack deploy -c docker-compose.yml traefik
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–ä½¿ç”¨ä»»ä½•ä½ å–œæ­¡çš„åç¨± &lt;code&gt;docker stack deploy -c docker-compose.yml traefik_stack_name&lt;/code&gt;&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;åœ¨ &lt;font color=#FF0000&gt; host1 &lt;/font&gt; å’Œ &lt;font color=#3FB6F5&gt; host2 &lt;/font&gt; æª¢æŸ¥&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker service ls
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¼¸å‡ºå¦‚ä¸‹ :&lt;/p&gt;
&lt;blockquote&gt;
ID             &amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
NAME              &amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
MODE         &amp;emsp;&amp;emsp;
REPLICAS   &amp;emsp;&amp;emsp;
IMAGE                  &amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
PORTS  
&lt;p&gt;rtafeiksid     â€ƒâ€ƒ
traefik_traefik   â€ƒâ€ƒ
replicated   â€ƒ
1/1        â€ƒâ€ƒâ€ƒâ€ƒ
traefik:latest&lt;/p&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h3 id=&#34;ç¬¬äº”æ­¥æ–°å¢-whoami-çš„-docker-composeyml&#34;&gt;ç¬¬äº”æ­¥ï¼Œæ–°å¢ whoami çš„ docker-compose.yml&lt;/h3&gt;
&lt;p&gt;åˆ‡æ›åˆ° &lt;font color=#3FB6F5&gt; host2 &lt;/font&gt; æ–°å¢å¦‚ä¸‹æ–¹çš„è³‡æ–™å¤¾å’Œæª”æ¡ˆ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–°å¢è³‡æ–™å¤¾ : &lt;code&gt;mkdir whoami&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é€²å…¥è³‡æ–™å¤¾ : &lt;code&gt;cd whoami&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ–°å¢æª”æ¡ˆ : &lt;code&gt;touch docker-compose.yml&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;whoami&lt;/strong&gt;&lt;br&gt;
â”” docker-compose.yml&lt;/p&gt;
&lt;p&gt;ç·¨è¼¯ &lt;a class=&#34;link&#34; href=&#34;https://github.com/penyt/traefik-docker-swarm/blob/main/whoami/docker-compose.yml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;docker-compose.yml
    
    
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    &lt;/a&gt; &lt;code&gt;nano docker-compose.yml&lt;/code&gt;ï¼ŒæŠŠé€£çµè£¡çš„å…§å®¹è²¼ä¸Š&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h3 id=&#34;ç¬¬å…­æ­¥éƒ¨ç½²-apps-whoami&#34;&gt;ç¬¬å…­æ­¥ï¼Œéƒ¨ç½² apps (whoami)&lt;/h3&gt;
&lt;p&gt;åœ¨ &lt;font color=#3FB6F5&gt; host2 &lt;/font&gt; åŸ·è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker stack deploy -c docker-compose.yml whoami
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–ä½¿ç”¨ä»»ä½•ä½ å–œæ­¡çš„åç¨± &lt;code&gt;docker stack deploy -c docker-compose.yml whoami_stack_name&lt;/code&gt;&lt;/p&gt;
&lt;br&gt;
&lt;p&gt;åœ¨ &lt;font color=#FF0000&gt; host1 &lt;/font&gt; å’Œ &lt;font color=#3FB6F5&gt; host2 &lt;/font&gt; æª¢æŸ¥&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker service ls
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¼¸å‡ºå¦‚ä¸‹ :&lt;/p&gt;
&lt;blockquote&gt;
ID             &amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
NAME              &amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
MODE         &amp;emsp;&amp;emsp;
REPLICAS   &amp;emsp;&amp;emsp;
IMAGE                  &amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
PORTS  
&lt;p&gt;rtafeiksid     â€ƒâ€ƒ
traefik_traefik   â€ƒâ€ƒâ€ƒâ€ƒ
replicated   â€ƒ
1/1        â€ƒâ€ƒâ€ƒâ€ƒ
traefik:latest&lt;/p&gt;
&lt;p&gt;whoidami   â€ƒâ€ƒ
whoami2_whoami2   â€ƒâ€ƒ
replicated   â€ƒ
1/1        â€ƒâ€ƒâ€ƒâ€ƒ
traefik/whoami:v1.10&lt;/p&gt;
&lt;/blockquote&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h3 id=&#34;ç¬¬ä¸ƒæ­¥å®Œæˆ&#34;&gt;ç¬¬ä¸ƒæ­¥ï¼Œå®Œæˆ&lt;/h3&gt;
&lt;p&gt;ç¾åœ¨ï¼Œæ‡‰è©²å¯ä»¥é€éä½ åœ¨ traefik æ¨™ç±¤è£¡è¨­ç½®çš„åŸŸåä¾†è¨ªå• traefik çš„ dashboard æˆ–æ˜¯ whoami çš„é é¢äº†&lt;/p&gt;
&lt;p&gt;è‹¥æœ‰å‡ºç¾ä»»ä½•éŒ¯èª¤ï¼Œè¨˜å¾—:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¢ºèªä½ çš„ DNS ç´€éŒ„æœ‰å°‡åŸŸåæŒ‡å‘ &lt;font color=#FF0000&gt; host1 &lt;/font&gt;&lt;/li&gt;
&lt;li&gt;æª¢æŸ¥ traefik çš„æ—¥èªŒ &lt;code&gt;docker service logs traefik_traefik&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æª¢æŸ¥ docker swarm çš„ overlay network &lt;code&gt;docker network inspect proxy&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;
&lt;br&gt;
by Pen
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;traefik deployment reference: &lt;a class=&#34;link&#34; href=&#34;https://github.com/JamesTurland/JimsGarage/blob/main/Traefik/docker-compose.yml&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;JimsGarage
    
    
    
    &lt;span style=&#34;white-space: nowrap;&#34;&gt;&lt;svg width=&#34;.7em&#34;
        height=&#34;.7em&#34; viewBox=&#34;0 0 21 21&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;
        &lt;path d=&#34;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&#34; fill=&#34;currentColor&#34; /&gt;
        &lt;path d=&#34;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&#34;
            fill=&#34;currentColor&#34;&gt;
    &lt;/svg&gt;&lt;/span&gt;
    &lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
        </item>
        
    </channel>
</rss>
